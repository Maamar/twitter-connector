<?xml version="1.0" encoding="UTF-8"?>
<mule xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:spring="http://www.springframework.org/schema/beans" xmlns:salesforce="http://www.mulesoft.org/schema/mule/salesforce"
    xmlns:twitter="http://www.mulesoft.org/schema/mule/twitter" xmlns:scripting="http://www.mulesoft.org/schema/mule/scripting"
    xmlns:smtp="http://www.mulesoft.org/schema/mule/smtp"
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="
        http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/3.1/mule.xsd
        http://www.mulesoft.org/schema/mule/twitter http://www.mulesoft.org/schema/mule/twitter/3.1/mule-twitter.xsd
        http://www.mulesoft.org/schema/mule/smtp http://www.mulesoft.org/schema/mule/smtp/3.1/mule-smtp.xsd
        http://www.mulesoft.org/schema/mule/scripting http://www.mulesoft.org/schema/mule/scripting/3.1/mule-scripting.xsd
        http://www.mulesoft.org/schema/mule/salesforce http://www.mulesoft.org/schema/mule/salesforce/3.1/mule-salesforce.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd        
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

    <context:property-placeholder
         location="classpath:.ibeans-credentials.properties" />

    <twitter:config name="twitter" />

    <twitter:config name="twitterJSON" format="JSON" />

    <twitter:config name="twitterOauthJSON" format="JSON" consumerKey="${twitter.consumer.key}"
        consumerSecret="${twitter.consumer.secret}" oauthToken="${twitter.access.token}"
        oauthTokenSecret="${twitter.access.secret}" />

    <twitter:config name="twitterOauthJSONNoUserConfig" consumerKey="${twitter.consumer.key}"
        consumerSecret="${twitter.consumer.secret}" format="JSON"  />

    <twitter:config name="twitterOauthATOM" format="ATOM" consumerKey="${twitter.consumer.key}"
        consumerSecret="${twitter.consumer.secret}" oauthToken="${twitter.access.token}"
        oauthTokenSecret="${twitter.access.secret}" />

    <twitter:config name="twitterOauthATOMNoUserConfig" format="ATOM" consumerKey="${twitter.consumer.key}"
        consumerSecret="${twitter.consumer.secret}" />


    <!-- Timeline -->

    <flow name="public-timeline">
        <twitter:public-timeline config-ref="twitter" />
    </flow>

    <flow name="public-timeline-json">
        <twitter:public-timeline config-ref="twitterJSON" />
    </flow>

    <flow name="user-timeline-json">
        <twitter:user-timeline config-ref="twitterOauthJSON" screenName="mulejockey"/>
    </flow>

    <flow name="user-timeline-json-with-user-creds">
        <twitter:user-timeline config-ref="twitterOauthJSONNoUserConfig" screenName="mulejockey" oauthToken="${twitter.access.token}"
        oauthTokenSecret="${twitter.access.secret}" />
    </flow>

    <flow name="friends-timeline-json">
        <twitter:friends-timeline config-ref="twitterOauthJSON"/>
    </flow>

    <flow name="friends-timeline-json-with-user-creds">
        <twitter:friends-timeline config-ref="twitterOauthJSONNoUserConfig" oauthToken="${twitter.access.token}"
        oauthTokenSecret="${twitter.access.secret}" />
    </flow>

    <flow name="mentions-json">
        <twitter:mentions config-ref="twitterOauthJSON" count="5"/>
    </flow>

    <flow name="mentions-json-with-user-creds">
        <twitter:mentions config-ref="twitterOauthJSONNoUserConfig" count="5" oauthToken="${twitter.access.token}"
        oauthTokenSecret="${twitter.access.secret}" />
    </flow>

    <!--  Search -->
    
    <flow name="search-atom">
        <twitter:search query="mulesoft" config-ref="twitterOauthATOM"/>
    </flow>

    <flow name="search-atom-with-user-creds">
        <twitter:search query="mulesoft" config-ref="twitterOauthATOMNoUserConfig" oauthToken="${twitter.access.token}"
        oauthTokenSecret="${twitter.access.secret}" />
    </flow>


    <!--  Status -->
    
    <flow name="update-status-json">
        <twitter:update-status status="#[variable:status]" config-ref="twitterOauthJSON"/>
    </flow>

    <flow name="update-status-json-with-user-creds">
        <twitter:update-status status="#[variable:status]" config-ref="twitterOauthJSONNoUserConfig" oauthToken="${twitter.access.token}"
        oauthTokenSecret="${twitter.access.secret}" />
    </flow>
    
    <flow name="show-status-json">
        <twitter:show-status statusId="#[variable:statusId]" config-ref="twitterOauthJSON"/>
    </flow>

    <flow name="show-status-json-with-user-creds">
        <twitter:show-status statusId="#[variable:statusId]" config-ref="twitterOauthJSONNoUserConfig" oauthToken="${twitter.access.token}"
        oauthTokenSecret="${twitter.access.secret}" />
    </flow>
    
    <!-- 
    <flow name="destroy-status-json">
        <twitter:destroy-status statusId="#[variable:statusId]" config-ref="twitterOauthJSON"/>
    </flow>
     -->
    <!--  User -->

    <flow name="lookup-user-json">
        <twitter:user screenName="mulejockey" config-ref="twitterOauthJSON"/>
    </flow>

    <flow name="lookup-user-json-with-user-creds">
        <twitter:user screenName="mulejockey" config-ref="twitterOauthJSONNoUserConfig" oauthToken="${twitter.access.token}"
        oauthTokenSecret="${twitter.access.secret}" />
    </flow>


</mule>
